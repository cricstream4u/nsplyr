<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Shaka Player - ClearKey + Custom Headers</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.6.0/shaka-player.compiled.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      background: #000;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    video {
      width: 90%;
      max-width: 960px;
      height: auto;
    }
  </style>
</head>
<body>

<video id="video" autoplay muted controls></video>

<script>
  async function initPlayer() {
    const manifestUri = "https://sshindidash-i.akamaihd.net/dash/live/2002466-b/sshindiwv/master.mpd";

    const keyId = 'fe7718fbb3fb4ba78c07cc0f578744e6';
    const key = '624e24b1843b459fab0a949609416f0d';

    const player = new shaka.Player(document.getElementById('video'));

    // Register request filter to add custom headers
    player.getNetworkingEngine().registerRequestFilter((type, request) => {
      if (type === shaka.net.NetworkingEngine.RequestType.MANIFEST ||
          type === shaka.net.NetworkingEngine.RequestType.SEGMENT) {
        request.headers['Cookie'] = 'hdntl=exp=1744123873~acl=*sshindi*~id=55c7acd55768bf4bad7ae7eb20a2b11f~data=hdntl~hmac=b51d4d1bc3033f35190013bcb5c4323643191b513134a7a70c60eb88c26c1e94';
        request.headers['User-Agent'] = 'Hotstar;in.startv.hotstar/25.02.24.8.11169 (Android/15)';
      }
    });

    // DRM configuration
    player.configure({
      drm: {
        clearKeys: {
          [keyId]: key
        }
      }
    });

    try {
      await player.load(manifestUri);
      console.log("Stream loaded!");
    } catch (e) {
      console.error("Error loading manifest:", e);
    }
  }

  document.addEventListener('DOMContentLoaded', initPlayer);
</script>

</body>
</html>
